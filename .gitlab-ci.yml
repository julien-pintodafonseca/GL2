# Gitlab ci/cd file configuration

default:
  image: "maven:3-openjdk-8"

variables:
  MAVEN_DEFAULT_OPTS: "-Dmaven.repo.local=.m2/repository"
  MAVEN_SIMPLE_TEST_OPTS: "-Dmaven.repo.local=.m2/repository -DskipSystemTests=true"

cache:
  paths:
    - .m2/repository/
    - target/

before_script:
  - export PATH=$PATH:"$CI_PROJECT_DIR/global/bin"
  - export PATH=$PATH:"$CI_PROJECT_DIR/src/main/bin"
  - export PATH=$PATH:"$CI_PROJECT_DIR/src/test/script"
  - export PATH=$PATH:"$CI_PROJECT_DIR/src/test/script/launchers"

stages:
  - build
  - simple-test
  - complete-test


build:
  stage: build
  script:
    - mvn clean compile $MAVEN_DEFAULT_OPTS

simple-test:
  stage: simple-test
  script:
    - mvn test $MAVEN_SIMPLE_TEST_OPTS

complete-test:
  stage: complete-test
  script:
    - mvn test $MAVEN_DEFAULT_OPTS
